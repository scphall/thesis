% This file contains all the default packages and modifications for
% LHCb formatting

%% %%%%%%%%%%%%%%%%%%
%%  Page formatting
%% %%%%%%%%%%%%%%%%%%
\textheight=230mm
\textwidth=160mm
\oddsidemargin=7mm
\evensidemargin=-10mm
\topmargin=-10mm
\headsep=20mm
\columnsep=5mm
\addtolength{\belowcaptionskip}{0.5em}

\renewcommand{\textfraction}{0.01}
\renewcommand{\floatpagefraction}{0.99}
\renewcommand{\topfraction}{0.9}
\renewcommand{\bottomfraction}{0.9}


\setlength{\hoffset}{-2cm}
\setlength{\voffset}{-2cm}
% Page defaults ...
\topmargin=0.5cm
\oddsidemargin=2.5cm
\textwidth=16cm
\textheight=22cm
% Allow the page size to vary a bit ...
\raggedbottom
% To avoid Latex to be too fussy with line breaking ...
\sloppy


%% %%%%%%%%%%%%%%%%%%
%%  Packages
%% %%%%%%%%%%%%%%%%%%
\usepackage{lipsum}
\usepackage{parskip}
\usepackage{xspace} % To avoid problems with missing or double spaces
\usepackage{subfig}
%\usepackage{subcaption}
\usepackage{graphicx}
\usepackage{color}
\usepackage{colortbl}
\usepackage{verse}
\usepackage{bbold}

\usepackage{tikz}
\usepackage{pdftricks}
\begin{psinputs}
  \usepackage{pstricks}
  \usepackage{pst-node}
\end{psinputs}
\usetikzlibrary{positioning,arrows,patterns}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{calc}

\usepackage{lineno} % for line numbering

%% Graphics
\graphicspath{{./figs/}
              {./figs/logos/}
              {./intro/figs/}
              {./theory/figs/}
              {./lhcb/figs/}
              {./dsphi/figs/}
              {./hhh/figs/}
              {./db/figs/}
              {./conc/figs/}}

%% Math
\usepackage{amsmath} % Adds a large collection of math symbols
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{upgreek} % Adds in support for greek letters in roman typeset
\usepackage{rotating}
\usepackage{setspace}
%\usepackage{fullpage}

\usepackage{preamble/tocloft}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\makeatletter
%\renewcommand{\@dotsep}{5000}
%\renewcommand*\l@section{\@dottedtocline{1}{1.5em}{2.3em}}
\makeatother
\renewcommand{\cftdot}{{\color{black!35}.}}


\usepackage[justification=justified,singlelinecheck=false]{caption}
\usepackage[labelfont=bf,format=hang]{caption}

\renewcommand{\abstractname}{}


\onehalfspacing


%\newcommand\firstsections

% FONTS
%\usepackage[T1]{fontenc}
%\renewcommand*\rmdefault{ppl}
%\renewcommand*\rmdefault{lmr}
%\renewcommand*\rmdefault{stix}
%\usepackage{fourier}
%\usepackage[T1]{fontenc}

%\fontseries{b}\selectfont
%\renewcommand{\bfdefault}{sb}
%bx bold extended (default)
%b bold
%sb semibold
%m medium
%c condensed

\usepackage{ifthen}
\newboolean{pdflatex}
\setboolean{pdflatex}{true} % False for eps figures

\newboolean{articletitles}
\setboolean{articletitles}{true} % False removes titles in references


\newboolean{uprightparticles}
\setboolean{uprightparticles}{false} %True for upright particle symbols

\usepackage{preamble/slashed}
%\usepackage[printonlyused,withpage]{acronym}
%\setacronymstyle{long-short}

%% fix to allow peaceful coexistence of line numbering and
%% mathematical objects
%% http://www.latex-community.org/forum/viewtopic.php?f=5&t=163
%%
\newcommand*\patchAmsMathEnvironmentForLineno[1]{%
\expandafter\let\csname old#1\expandafter\endcsname\csname #1\endcsname
\expandafter\let\csname oldend#1\expandafter\endcsname\csname
end#1\endcsname
 \renewenvironment{#1}%
   {\linenomath\csname old#1\endcsname}%
   {\csname oldend#1\endcsname\endlinenomath}%
}
\newcommand*\patchBothAmsMathEnvironmentsForLineno[1]{%
  \patchAmsMathEnvironmentForLineno{#1}%
  \patchAmsMathEnvironmentForLineno{#1*}%
}
\AtBeginDocument{%
\patchBothAmsMathEnvironmentsForLineno{equation}%
\patchBothAmsMathEnvironmentsForLineno{align}%
\patchBothAmsMathEnvironmentsForLineno{flalign}%
\patchBothAmsMathEnvironmentsForLineno{alignat}%
\patchBothAmsMathEnvironmentsForLineno{gather}%
\patchBothAmsMathEnvironmentsForLineno{multline}%
}



% Get hyperlinks to captions and in references.
% These do not work with revtex. Use "hypertext" as class option instead.
\usepackage{hyperref}    % Hyperlinks in references
\usepackage[all]{hypcap} % Internal hyperlinks to floats.

%\usepackage[acronym]{glossaries}
\usepackage[nopostdot,nogroupskip,xindy,nonumberlist]{glossaries}
%\setglossarystyle{altlist}
%\usepackage{glossary-mcols}
%\setglossarystyle{mcolindex}

\makeglossaries
\input{preamble/glossary} % Add in the glossary

\input{preamble/lhcb-symbols} % Add in the predefined LHCb symbols
\input{preamble/symbols} % Add in the predefined LHCb symbols

\usepackage{fancyhdr}
\pagestyle{fancy}
\cfoot{} % kill central lage number
\fancyhf{}
\renewcommand{\chaptermark}[1]{ \markboth{{\bf #1}}{} }
\renewcommand{\sectionmark}[1]{ \markright{{\bf #1}}{} }


\fancyhead[LE,RO]{}
%\fancyhead[LE,RO]{{\bf \thepage}}
%\fancyhead[RE,LO]{{\bf \thechapter.}~\leftmark}
\fancyhead[RE,LO]{}
\fancyfoot[CE,CO]{}
\fancyfoot[LE,RO]{}
\fancyfoot[C]{{\bf \thepage}}
%\fancyhead[RE]{\chaptername~\thechapter}
\renewcommand{\headrulewidth}{0.5pt}
%\renewcommand{\footrulewidth}{1pt}
%\cfoot{} % kill central lage number

% Redefine the plain page style
\fancypagestyle{plain}{%
  \fancyhf{}%
  \fancyfoot[C]{{\bf \thepage}}%
  \renewcommand{\headrulewidth}{0pt}% Line at the header invisible
  \renewcommand{\footrulewidth}{0pt}% Line at the footer visible
}





% Make this the last packages you include before the \begin{document}
\usepackage{cite} % Allows for ranges in citations
\usepackage{mciteplus}

